# Naive benchmarking...

Removed async code, as there was some issues with threading and reads.
Added criterium based benchmarking for the reads, and fixed payload size bug.


## 500K keys, 360B each, with 10KB payload
```
λ lein run
18-11-15 22:22:25 Lambdabeast2 INFO [redisbench.core:121] - Starting...
18-11-15 22:22:25 Lambdabeast2 INFO [redisbench.core:122] - Inserting 500000 keys with 10000 bytes each...
18-11-15 22:23:18 Lambdabeast2 INFO [redisbench.core:128] - Inserts took 53.561s (0.107122ms per insert)
18-11-15 22:23:18 Lambdabeast2 INFO [redisbench.core:129] - Starting read benchmark...
Estimating sampling overhead
Warming up for JIT optimisations 10000000000 ...
  compilation occurred before 830336 iterations
  compilation occurred before 107086464 iterations
  compilation occurred before 209191962 iterations
  compilation occurred before 211682340 iterations
  compilation occurred before 317938468 iterations
  compilation occurred before 424194596 iterations
  classes loaded before 670742018 iterations
Estimating execution count ...
Sampling ...
Final GC...
Checking GC...
Finding outliers ...
Bootstrapping ...
Checking outlier significance
Warming up for JIT optimisations 5000000000 ...
  compilation occurred before 6078 iterations
Estimating execution count ...
Sampling ...
Final GC...
Checking GC...
Finding outliers ...
Bootstrapping ...
Checking outlier significance
Evaluation count : 7278 in 6 samples of 1213 calls.
             Execution time mean : 76.761927 µs
    Execution time std-deviation : 6.446678 µs
   Execution time lower quantile : 70.239845 µs ( 2.5%)
   Execution time upper quantile : 83.911379 µs (97.5%)
                   Overhead used : 9.017062 ns
```

## 500K keys, 360B each, with 1KB payload
```
λ lein run
18-11-15 22:30:08 Lambdabeast2 INFO [redisbench.core:121] - Starting...
18-11-15 22:30:08 Lambdabeast2 INFO [redisbench.core:122] - Inserting 500000 keys with 1000 bytes each...
18-11-15 22:30:42 Lambdabeast2 INFO [redisbench.core:128] - Inserts took 33.79s (0.06758ms per insert)
18-11-15 22:30:42 Lambdabeast2 INFO [redisbench.core:129] - Starting read benchmark...
Estimating sampling overhead
Warming up for JIT optimisations 10000000000 ...
  compilation occurred before 104950467 iterations
  compilation occurred before 109182332 iterations
  compilation occurred before 214978957 iterations
  compilation occurred before 324161074 iterations
  compilation occurred before 432496818 iterations
Estimating execution count ...
Sampling ...
Final GC...
Checking GC...
Finding outliers ...
Bootstrapping ...
Checking outlier significance
Warming up for JIT optimisations 5000000000 ...
  compilation occurred before 9768 iterations
Estimating execution count ...
Sampling ...
Final GC...
Checking GC...
Finding outliers ...
Bootstrapping ...
Checking outlier significance
Evaluation count : 12402 in 6 samples of 2067 calls.
             Execution time mean : 49.882914 µs
    Execution time std-deviation : 12.579224 µs
   Execution time lower quantile : 43.662113 µs ( 2.5%)
   Execution time upper quantile : 71.496311 µs (97.5%)
                   Overhead used : 8.851501 ns

Found 1 outliers in 6 samples (16.6667 %)
        low-severe       1 (16.6667 %)
 Variance from outliers : 64.8466 % Variance is severely inflated by outliers
```
